<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ” Device Identity & DPoP Security Demo</title>
    <link rel="stylesheet" href="/public/style.css">

</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ” Device Identity & DPoP Security</h1>
            <p>A comprehensive reference implementation demonstrating device identity management using non-exportable WebCrypto keys and DPoP (Demonstration of Proof-of-Possession) tokens for advanced cryptographic security.</p>
        </div>

        <div class="demo-section fade-in">
            <h2>ğŸš€ Key Features</h2>
            <div class="feature-grid">
                <div class="feature-card">
                    <h4>ğŸ” Device Identity & Browser-Bound Keys</h4>
                    <p>Browser-bound cryptographic identity using WebCrypto API. Keys are non-exportable and persist across browser sessions, but remain within the secure browser context. Not hardware-backed like HSM keys, but provides device authentication within browser security model.</p>
                </div>
                <div class="feature-card">
                    <h4>ğŸ›¡ï¸ Identity Continuity & ATO Protection</h4>
                    <p>DPoP tokens with client and server signing for two-way verification, providing identity continuity and limiting account takeover attack vectors through cryptographic request binding.</p>
                </div>
                <div class="feature-card">
                    <h4>ğŸ“± Cross-Device Security & VDI Support</h4>
                    <p>Corporate VDI authentication and step-up security using QR codes. Enables authentication in virtual desktop environments where WebAuthn/Passkeys are unavailable.</p>
                </div>
                <div class="feature-card">
                    <h4>âš¡ Advanced Web Security</h4>
                    <p>Service worker request interception, secure headers, CSRF protection, and comprehensive input validation for enterprise-grade security.</p>
                </div>
            </div>
        </div>

        <div class="demo-section fade-in">
            <h2>ğŸ® Interactive Demo</h2>
            <p style="color: var(--text-muted); margin-bottom: 1.5rem;">
                Follow the execution story below to experience the complete device identity and cryptographic security workflow:
            </p>
            
            <div class="demo-sequence">
                <div class="sequence-step">
                    <div class="step-number">1</div>
                    <button id="initBtn" class="btn btn-primary">
                        ğŸ”„ Initialize Session
                    </button>
                </div>
                <div class="sequence-step">
                    <div class="step-number">2</div>
                    <button id="bikBtn" class="btn btn-primary" disabled>
                        ğŸ”‘ Register Browser Identity
                    </button>
                </div>
                <div class="sequence-step">
                    <div class="step-number">3</div>
                    <button id="dpopBtn" class="btn btn-primary" disabled>
                        ğŸ›¡ï¸ Bind DPoP Token
                    </button>
                </div>
                <div class="sequence-step">
                    <div class="step-number">4</div>
                    <button id="apiBtn" class="btn btn-primary" disabled>
                        ğŸŒ Test API Access
                    </button>
                </div>
                <div class="sequence-step">
                    <div class="step-number">5</div>
                    <button id="regBtn" class="btn btn-secondary" disabled>
                        ğŸ“ Register Device Identity
                    </button>
                </div>
                <div class="sequence-step">
                    <div class="step-number">6</div>
                    <button id="authBtn" class="btn btn-secondary" disabled>
                        ğŸ” Authenticate Device Identity
                    </button>
                </div>
                <div class="sequence-step">
                    <div class="step-number">7</div>
                    <button id="linkBtn" class="btn btn-accent" disabled>
                        ğŸ“± Start Cross-Device Link (VDI/Step-up)
                    </button>
                </div>
            </div>
        </div>

        <div class="demo-section fade-in">
            <h2>ğŸ”§ Admin & Testing</h2>
            <p style="color: var(--text-muted); margin-bottom: 1.5rem;">
                Administrative functions and service worker testing:
            </p>
            
            <div class="button-grid">
                <button id="flushBtn" class="btn btn-secondary">
                    ğŸ—‘ï¸ Server Flush
                </button>
                <button id="clientFlushBtn" class="btn btn-secondary">
                    ğŸ§¹ Client Flush
                </button>
                <button id="swRegBtn" class="btn btn-secondary">
                    ğŸ“ Register Service Worker
                </button>
                <button id="swUnregBtn" class="btn btn-secondary">
                    âŒ Unregister Service Worker
                </button>
                <button id="echoSWBtn" class="btn btn-secondary">
                    ğŸŒ Test SW Echo
                </button>
            </div>
        </div>



        <div class="demo-section fade-in">
            <h2>ğŸ“ Activity Log</h2>
            <div class="log-section" id="logContainer">
                <div class="log-entry info">[INFO] Demo page loaded. Ready to start the browser identity journey!</div>
            </div>
        </div>

        <div class="demo-section fade-in">
            <h2>ğŸ›¡ï¸ Security Features</h2>
            <div class="tech-stack">
                <span class="tech-tag">Non-exportable Keys</span>
                <span class="tech-tag">Device Identity Binding</span>
                <span class="tech-tag">DPoP Token Binding</span>
                <span class="tech-tag">Two-Way Verification</span>
                <span class="tech-tag">Replay Attack Prevention</span>
                <span class="tech-tag">Man-in-the-Middle Protection</span>
                <span class="tech-tag">Identity Continuity</span>
                <span class="tech-tag">ATO Protection</span>
                <span class="tech-tag">Cross-Device Security</span>
                <span class="tech-tag">VDI Authentication</span>
                <span class="tech-tag">Step-up Authentication</span>
                <span class="tech-tag">CSRF Protection</span>
                <span class="tech-tag">Secure Request Signing</span>
            </div>
        </div>

        <div class="footer fade-in">
            <div class="footer-content">
                <p>ğŸ”— <strong>Reference Implementation</strong> - View the complete source code and documentation:</p>
                <a href="https://github.com/gavinhamilton1/dpop-demo" target="_blank" rel="noopener noreferrer" class="github-link">
                    ğŸ“‚ GitHub Repository
                </a>
            </div>
        </div>
    </div>

    <script src="/public/qrcode.min.js"></script>
    <script type="module" src="/public/app.js?v=1"></script>
</body>
</html>
